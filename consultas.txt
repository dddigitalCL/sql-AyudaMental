
-- PREGUNTA 1
SELECT  TEST.PROGRAMA, COUNT (CURSO.ID_CURSO) AS CANTIDAD, CURSO.ID_CURSO FROM CURSO
INNER JOIN ALUMNO ON CURSO.ID_CURSO = ALUMNO.CURSO_ID_CURSO
INNER JOIN TEST ON TEST.ID_TEST = ALUMNO.TEST_ID_TEST
GROUP BY CURSO.ID_CURSO,TEST.PROGRAMA
ORDER BY CURSO.ID_CURSO;

--PREGUNTA 2
SELECT CURSO.ID_CURSO, TEST.DESCRIPCION_TEST FROM CURSO
INNER JOIN ALUMNO ON ALUMNO.CURSO_ID_CURSO = CURSO.ID_CURSO
INNER JOIN TEST ON TEST.ID_TEST = ALUMNO.TEST_ID_TEST
WHERE CURSO.ID_CURSO>'2';

--PREGUNTA 3
--A
    SELECT TEST.NOMBRE_TEST, COUNT (PREGUNTAS.ID_PREGUNTAS) FROM TEST
    INNER JOIN PREGUNTAS ON PREGUNTAS.TEST_ID_TEST = TEST.ID_TEST
    GROUP BY TEST.NOMBRE_TEST
    ORDER BY TEST.NOMBRE_TEST;
    
--B
    SELECT DISTINCT PREGUNTAS.ENUNCIADO,ALTERNATIVAS.ID_ALTERNATIVAS AS CANTIDAD_ALTERNATIVAS FROM PREGUNTAS
    INNER JOIN PREGUNTA_ALTERNATIVA ON ID_PREGUNTAS = ID_PREGUNTAS
    INNER JOIN ALTERNATIVAS ON ALTERNATIVAS.ID_ALTERNATIVAS = PREGUNTA_ALTERNATIVA.ALTERNATIVAS_ID_ALTERNATIVAS
    WHERE ID_ALTERNATIVAS = 4
    ORDER BY ENUNCIADO;
    
--C
    --CORRECTAS
    SELECT PREGUNTAS_ID_PREGUNTAS AS PREGUNTA, ALTERNATIVAS_ID_ALTERNATIVAS AS ALTERNATIVA_CORRECTA 
    FROM PREGUNTA_ALTERNATIVA
    WHERE VALOR = 1
    ORDER BY PREGUNTAS_ID_PREGUNTAS;
   
    --INCORRECTAS
    SELECT PREGUNTAS_ID_PREGUNTAS AS PREGUNTA, ALTERNATIVAS_ID_ALTERNATIVAS AS ALTERNATIVA_CORRECTA 
    FROM PREGUNTA_ALTERNATIVA
    WHERE VALOR = 0
    ORDER BY PREGUNTAS_ID_PREGUNTAS;
    

--PREGUNTA 4
SELECT CURSO.ID_CURSO AS CURSO, COUNT (ALUMNO.ID_ALUMNO) AS CANTIDAD_ALUMNOS FROM CURSO
INNER JOIN ALUMNO ON ALUMNO.CURSO_ID_CURSO = CURSO.ID_CURSO
WHERE ID_CURSO<3
GROUP BY CURSO.ID_CURSO;


--PREGUNTA 5
SELECT ALUMNO.NOMBRE, COUNT (RESULTADO.PREGUNTAS_ID_PREGUNTAS) AS PREGUNTAS_CORRECTAS FROM RESULTADO
INNER JOIN ALUMNO ON ALUMNO.ID_ALUMNO = RESULTADO.ALUMNO_ID_ALUMNO
WHERE ALTERNATIVAS_ID_ALTERNATIVAS IN (SELECT VALOR FROM PREGUNTA_ALTERNATIVA 
                                     WHERE VALOR =1)
GROUP BY ALUMNO.NOMBRE
ORDER BY ALUMNO.NOMBRE;

--PREGUNTA 6

--PREGUNTA 7
SELECT CURSO.ID_CURSO, ALUMNO.NOMBRE, COUNT (RESULTADO.PREGUNTAS_ID_PREGUNTAS) AS PREGUNTAS_CORRECTAS FROM RESULTADO
INNER JOIN ALUMNO ON ALUMNO.ID_ALUMNO = RESULTADO.ALUMNO_ID_ALUMNO
INNER JOIN CURSO ON CURSO.ID_CURSO = ALUMNO.CURSO_ID_CURSO
WHERE ALTERNATIVAS_ID_ALTERNATIVAS IN (SELECT VALOR FROM PREGUNTA_ALTERNATIVA 
                                     WHERE VALOR =1)
GROUP BY CURSO.ID_CURSO,ALUMNO.NOMBRE
HAVING COUNT (RESULTADO.PREGUNTAS_ID_PREGUNTAS) >=2
ORDER BY ID_CURSO,ALUMNO.NOMBRE;


--PREGUNTA 8


SELECT  CURSO.ID_CURSO AS CURSO, TEST.NOMBRE_TEST AS TEST, SUM(PREGUNTAS.PUNTAJE) as PUNTAJE_TOTAL FROM ALUMNO
INNER JOIN TEST ON TEST.ID_TEST = ALUMNO.TEST_ID_TEST
INNER JOIN CURSO ON CURSO.ID_CURSO = ALUMNO.CURSO_ID_CURSO
INNER JOIN RESULTADO ON RESULTADO.ALUMNO_ID_ALUMNO = ALUMNO.ID_ALUMNO
INNER JOIN PREGUNTAS ON PREGUNTAS.ID_PREGUNTAS = RESULTADO.PREGUNTAS_ID_PREGUNTAS
WHERE ALTERNATIVAS_ID_ALTERNATIVAS IN (SELECT VALOR FROM PREGUNTA_ALTERNATIVA 
                                     WHERE VALOR =1)
GROUP BY CURSO.ID_CURSO, TEST.NOMBRE_TEST, PREGUNTAS.PUNTAJE
ORDER BY CURSO.ID_CURSO, TEST.NOMBRE_TEST;


