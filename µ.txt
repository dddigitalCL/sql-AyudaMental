  
-- CURSOS
INSERT INTO CURSO VALUES ('1');
INSERT INTO CURSO VALUES ('2');
INSERT INTO CURSO VALUES ('3');

--INSERTANDO LOS 2 TEST
INSERT INTO TEST VALUES (1,'PRIMER TEST','PREGUNTAS VARIAS','Programación FullStack Java Trainnie','Unidad - Base de Datos','Mario Canedo','13/MAR/2020');
INSERT INTO TEST VALUES (2,'SEGUNDO TEST','PREGUNTAS VARIAS Android','Programación Android','Unidad - Base de Datos Android','Albert Enstein','13/MAR/2020');


CREATE SEQUENCE SEQ_ALUMNO_EVALUACION
START WITH 1
INCREMENT BY 1
NOMAXVALUE;


CREATE TRIGGER (nombre del trigger ejemplo persona_trigger) BEFORE
    INSERT ON (nombre de la tabla)
    FOR EACH ROW
BEGIN
    :new.(ID o dato que se le aplicara el trigger) := (nombre de la secuencia "YA creada" priemro se crea la secuencia).nextval;
END;

Los parentesis NO VAN




-- ALUMNOS CURSO 1
INSERT INTO ALUMNO VALUES (SEQ_ALUMNO_EVALUACION.NEXTVAL,'19224358-0','Jose Solla','1','1');
INSERT INTO ALUMNO VALUES (SEQ_ALUMNO_EVALUACION.NEXTVAL,'13373838-5','Fernando Erro','1','1');
INSERT INTO ALUMNO VALUES (SEQ_ALUMNO_EVALUACION.NEXTVAL,'18347273-9','Xavier Reales','1','1');
INSERT INTO ALUMNO VALUES (SEQ_ALUMNO_EVALUACION.NEXTVAL,'9282727-5','Jesus Cepero','1','1');
INSERT INTO ALUMNO VALUES (SEQ_ALUMNO_EVALUACION.NEXTVAL,'13373838-5','Noema Llarena','1','2');
INSERT INTO ALUMNO VALUES (SEQ_ALUMNO_EVALUACION.NEXTVAL,'18347273-9','Norah San Miguel','1','2');
INSERT INTO ALUMNO VALUES (SEQ_ALUMNO_EVALUACION.NEXTVAL,'9282727-5','Celeste Torrent','1','2');

--ALUMNOS CURSO 2
INSERT INTO ALUMNO VALUES (SEQ_ALUMNO_EVALUACION.NEXTVAL,'18726345-9','Gregorio Queiruga','2','1');
INSERT INTO ALUMNO VALUES (SEQ_ALUMNO_EVALUACION.NEXTVAL,'7090900-6','Daiana Sanchis    ','2','1');
INSERT INTO ALUMNO VALUES (SEQ_ALUMNO_EVALUACION.NEXTVAL,'20352463-3','Laureano Outeiral','2','1');
INSERT INTO ALUMNO VALUES (SEQ_ALUMNO_EVALUACION.NEXTVAL,'7187736-1','Iratze Sarango','2','1');
INSERT INTO ALUMNO VALUES (SEQ_ALUMNO_EVALUACION.NEXTVAL,'15237552-2','Yon Escaño','2','2');
INSERT INTO ALUMNO VALUES (SEQ_ALUMNO_EVALUACION.NEXTVAL,'24751943-2','Rosa Amalia De Paz','2','2');
INSERT INTO ALUMNO VALUES (SEQ_ALUMNO_EVALUACION.NEXTVAL,'17639561-3','Zebensui Llinas','2','2');

--ALUMNOS CURSO 3


--PREGUNTAS TEST 1
INSERT INTO PREGUNTAS VALUES (1,'PRIMERA PREGUNTA',33,1);
INSERT INTO PREGUNTAS VALUES (2,'SEGUNDA PREGUNTA',33,1);
INSERT INTO PREGUNTAS VALUES (3,'TERCERA PREGUNTA',33,1);
INSERT INTO PREGUNTAS VALUES (4,'CUARTA PREGUNTA',33,1);

--PREGUNTAS TEST 2
INSERT INTO PREGUNTAS VALUES (5,'PRIMERA PREGUNTA',33,2);
INSERT INTO PREGUNTAS VALUES (6,'SEGUNDA PREGUNTA',33,2);
INSERT INTO PREGUNTAS VALUES (7,'TERCERA PREGUNTA',33,2);
INSERT INTO PREGUNTAS VALUES (8,'CUARTA PREGUNTA',33,2);


-- ALTERNATIVAS
INSERT INTO ALTERNATIVAS VALUES (1,'ALTERNATIVA 1');
INSERT INTO ALTERNATIVAS VALUES (2,'ALTERNATIVA 2');
INSERT INTO ALTERNATIVAS VALUES (3,'ALTERNATIVA 3');
INSERT INTO ALTERNATIVAS VALUES (4,'ALTERNATIVA 4');


-- PREGUNTA_ALTERNATRIVA PORCENTAJES Y PUNTAJE

--PREGUNTA1 
INSERT INTO PREGUNTA_ALTERNATIVA VALUES (1,1,1,50);
INSERT INTO PREGUNTA_ALTERNATIVA VALUES (1,2,1,50);
INSERT INTO PREGUNTA_ALTERNATIVA VALUES (1,3,0,0);
INSERT INTO PREGUNTA_ALTERNATIVA VALUES (1,4,0,0);
--PREGUNTA2
INSERT INTO PREGUNTA_ALTERNATIVA VALUES (2,1,1,50);
INSERT INTO PREGUNTA_ALTERNATIVA VALUES (2,2,0,0);
INSERT INTO PREGUNTA_ALTERNATIVA VALUES (2,3,1,50);
INSERT INTO PREGUNTA_ALTERNATIVA VALUES (2,4,0,0);
--PREGUNTA3
INSERT INTO PREGUNTA_ALTERNATIVA VALUES (3,1,0,0);
INSERT INTO PREGUNTA_ALTERNATIVA VALUES (3,2,0,0);
INSERT INTO PREGUNTA_ALTERNATIVA VALUES (3,3,1,50);
INSERT INTO PREGUNTA_ALTERNATIVA VALUES (3,4,1,50);
--PREGUNTA4 
INSERT INTO PREGUNTA_ALTERNATIVA VALUES (4,1,0,0);
INSERT INTO PREGUNTA_ALTERNATIVA VALUES (4,2,0,0);
INSERT INTO PREGUNTA_ALTERNATIVA VALUES (4,3,1,50);
INSERT INTO PREGUNTA_ALTERNATIVA VALUES (4,4,1,50);
--PREGUNTA5 
INSERT INTO PREGUNTA_ALTERNATIVA VALUES (5,1,1,50);
INSERT INTO PREGUNTA_ALTERNATIVA VALUES (5,2,0,0);
INSERT INTO PREGUNTA_ALTERNATIVA VALUES (5,3,0,0);
INSERT INTO PREGUNTA_ALTERNATIVA VALUES (5,4,1,50);
--PREGUNTA6 
INSERT INTO PREGUNTA_ALTERNATIVA VALUES (6,1,0,0);
INSERT INTO PREGUNTA_ALTERNATIVA VALUES (6,2,1,50);
INSERT INTO PREGUNTA_ALTERNATIVA VALUES (6,3,0,0);
INSERT INTO PREGUNTA_ALTERNATIVA VALUES (6,4,1,50);
--PREGUNTA7 
INSERT INTO PREGUNTA_ALTERNATIVA VALUES (7,1,0,0);
INSERT INTO PREGUNTA_ALTERNATIVA VALUES (7,2,0,0);
INSERT INTO PREGUNTA_ALTERNATIVA VALUES (7,3,1,50);
INSERT INTO PREGUNTA_ALTERNATIVA VALUES (7,4,1,50);
--PREGUNTA8 
INSERT INTO PREGUNTA_ALTERNATIVA VALUES (8,1,1,50);
INSERT INTO PREGUNTA_ALTERNATIVA VALUES (8,2,1,50);
INSERT INTO PREGUNTA_ALTERNATIVA VALUES (8,3,0,0);
INSERT INTO PREGUNTA_ALTERNATIVA VALUES (8,4,0,0);




--RESULTADOS ALUMNOS TEST 1

INSERT INTO RESULTADO VALUES (1,1,1);
INSERT INTO RESULTADO VALUES (1,3,1);
INSERT INTO RESULTADO VALUES (1,2,2);
INSERT INTO RESULTADO VALUES (1,3,2);
INSERT INTO RESULTADO VALUES (1,1,3);
INSERT INTO RESULTADO VALUES (1,4,3);
INSERT INTO RESULTADO VALUES (1,2,4);
INSERT INTO RESULTADO VALUES (1,3,4);

INSERT INTO RESULTADO VALUES (2,3,1);
INSERT INTO RESULTADO VALUES (2,2,1);
INSERT INTO RESULTADO VALUES (2,1,2);
INSERT INTO RESULTADO VALUES (2,4,2);
INSERT INTO RESULTADO VALUES (2,2,3);
INSERT INTO RESULTADO VALUES (2,1,3);
INSERT INTO RESULTADO VALUES (2,2,4);
INSERT INTO RESULTADO VALUES (2,3,4);

INSERT INTO RESULTADO VALUES (3,1,1);
INSERT INTO RESULTADO VALUES (3,2,1);
INSERT INTO RESULTADO VALUES (3,2,2);
INSERT INTO RESULTADO VALUES (3,1,2);
INSERT INTO RESULTADO VALUES (3,4,3);
INSERT INTO RESULTADO VALUES (3,1,3);
INSERT INTO RESULTADO VALUES (3,3,4);
INSERT INTO RESULTADO VALUES (3,1,4);

INSERT INTO RESULTADO VALUES (4,1,1);
INSERT INTO RESULTADO VALUES (4,3,1);
INSERT INTO RESULTADO VALUES (4,4,2);
INSERT INTO RESULTADO VALUES (4,3,2);
INSERT INTO RESULTADO VALUES (4,4,3);
INSERT INTO RESULTADO VALUES (4,3,3);
INSERT INTO RESULTADO VALUES (4,1,4);
INSERT INTO RESULTADO VALUES (4,2,4);

INSERT INTO RESULTADO VALUES (5,1,1);
INSERT INTO RESULTADO VALUES (5,2,1);
INSERT INTO RESULTADO VALUES (5,4,2);
INSERT INTO RESULTADO VALUES (5,1,2);
INSERT INTO RESULTADO VALUES (5,3,3);
INSERT INTO RESULTADO VALUES (5,2,3);
INSERT INTO RESULTADO VALUES (5,1,4);
INSERT INTO RESULTADO VALUES (5,4,4);

INSERT INTO RESULTADO VALUES (6,2,1);
INSERT INTO RESULTADO VALUES (6,4,1);
INSERT INTO RESULTADO VALUES (6,3,2);
INSERT INTO RESULTADO VALUES (6,1,2);
INSERT INTO RESULTADO VALUES (6,4,3);
INSERT INTO RESULTADO VALUES (6,2,3);
INSERT INTO RESULTADO VALUES (6,1,4);
INSERT INTO RESULTADO VALUES (6,4,4);

INSERT INTO RESULTADO VALUES (7,1,1);
INSERT INTO RESULTADO VALUES (7,3,1);
INSERT INTO RESULTADO VALUES (7,2,2);
INSERT INTO RESULTADO VALUES (7,4,2);
INSERT INTO RESULTADO VALUES (7,2,3);
INSERT INTO RESULTADO VALUES (7,1,3);
INSERT INTO RESULTADO VALUES (7,4,4);
INSERT INTO RESULTADO VALUES (7,1,4);

-- ALUMNOS TEST 2
INSERT INTO RESULTADO VALUES (8,1,5);
INSERT INTO RESULTADO VALUES (8,3,5);
INSERT INTO RESULTADO VALUES (8,2,6);
INSERT INTO RESULTADO VALUES (8,3,6);
INSERT INTO RESULTADO VALUES (8,1,7);
INSERT INTO RESULTADO VALUES (8,4,7);
INSERT INTO RESULTADO VALUES (8,2,8);
INSERT INTO RESULTADO VALUES (8,3,8);

INSERT INTO RESULTADO VALUES (9,3,5);
INSERT INTO RESULTADO VALUES (9,2,5);
INSERT INTO RESULTADO VALUES (9,1,6);
INSERT INTO RESULTADO VALUES (9,4,6);
INSERT INTO RESULTADO VALUES (9,2,7);
INSERT INTO RESULTADO VALUES (9,1,7);
INSERT INTO RESULTADO VALUES (9,2,8);
INSERT INTO RESULTADO VALUES (9,3,8);

INSERT INTO RESULTADO VALUES (10,1,5);
INSERT INTO RESULTADO VALUES (10,2,5);
INSERT INTO RESULTADO VALUES (10,2,6);
INSERT INTO RESULTADO VALUES (10,1,6);
INSERT INTO RESULTADO VALUES (10,4,7);
INSERT INTO RESULTADO VALUES (10,1,7);
INSERT INTO RESULTADO VALUES (10,3,8);
INSERT INTO RESULTADO VALUES (10,1,8);

INSERT INTO RESULTADO VALUES (11,1,5);
INSERT INTO RESULTADO VALUES (11,3,5);
INSERT INTO RESULTADO VALUES (11,4,6);
INSERT INTO RESULTADO VALUES (11,3,6);
INSERT INTO RESULTADO VALUES (11,4,7);
INSERT INTO RESULTADO VALUES (11,3,7);
INSERT INTO RESULTADO VALUES (11,1,8);
INSERT INTO RESULTADO VALUES (11,2,8);

INSERT INTO RESULTADO VALUES (12,1,5);
INSERT INTO RESULTADO VALUES (12,2,5);
INSERT INTO RESULTADO VALUES (12,4,6);
INSERT INTO RESULTADO VALUES (12,1,6);
INSERT INTO RESULTADO VALUES (12,3,7);
INSERT INTO RESULTADO VALUES (12,2,7);
INSERT INTO RESULTADO VALUES (12,1,8);
INSERT INTO RESULTADO VALUES (12,4,8);

INSERT INTO RESULTADO VALUES (13,2,5);
INSERT INTO RESULTADO VALUES (13,4,5);
INSERT INTO RESULTADO VALUES (13,3,6);
INSERT INTO RESULTADO VALUES (13,1,6);
INSERT INTO RESULTADO VALUES (13,4,7);
INSERT INTO RESULTADO VALUES (13,2,7);
INSERT INTO RESULTADO VALUES (13,1,8);
INSERT INTO RESULTADO VALUES (13,4,8);

INSERT INTO RESULTADO VALUES (14,1,5);
INSERT INTO RESULTADO VALUES (14,3,5);
INSERT INTO RESULTADO VALUES (14,2,6);
INSERT INTO RESULTADO VALUES (14,4,6);
INSERT INTO RESULTADO VALUES (14,2,7);
INSERT INTO RESULTADO VALUES (14,1,7);
INSERT INTO RESULTADO VALUES (14,4,8);
INSERT INTO RESULTADO VALUES (14,1,8);

/*  CONSULTAS
    CONSULTAS
    CONSULTAS */

-- PREGUNTA 1
SELECT  TEST.PROGRAMA, COUNT (CURSO.ID_CURSO) AS CANTIDAD, CURSO.ID_CURSO FROM CURSO
INNER JOIN ALUMNO ON CURSO.ID_CURSO = ALUMNO.CURSO_ID_CURSO
INNER JOIN TEST ON TEST.ID_TEST = ALUMNO.TEST_ID_TEST
GROUP BY CURSO.ID_CURSO,TEST.PROGRAMA
ORDER BY CURSO.ID_CURSO;

--PREGUNTA 2
SELECT CURSO.ID_CURSO, TEST.DESCRIPCION_TEST FROM CURSO
INNER JOIN ALUMNO ON ALUMNO.CURSO_ID_CURSO = CURSO.ID_CURSO
INNER JOIN TEST ON TEST.ID_TEST = ALUMNO.TEST_ID_TEST
WHERE CURSO.ID_CURSO>'2';

--PREGUNTA 3
--A
    SELECT TEST.NOMBRE_TEST, COUNT (PREGUNTAS.ID_PREGUNTAS) FROM TEST
    INNER JOIN PREGUNTAS ON PREGUNTAS.TEST_ID_TEST = TEST.ID_TEST
    GROUP BY TEST.NOMBRE_TEST
    ORDER BY TEST.NOMBRE_TEST;
    
--B
    SELECT DISTINCT PREGUNTAS.ENUNCIADO,ALTERNATIVAS.ID_ALTERNATIVAS AS CANTIDAD_ALTERNATIVAS FROM PREGUNTAS
    INNER JOIN PREGUNTA_ALTERNATIVA ON ID_PREGUNTAS = ID_PREGUNTAS
    INNER JOIN ALTERNATIVAS ON ALTERNATIVAS.ID_ALTERNATIVAS = PREGUNTA_ALTERNATIVA.ALTERNATIVAS_ID_ALTERNATIVAS
    WHERE ID_ALTERNATIVAS = 4
    ORDER BY ENUNCIADO;
    
--C
    --CORRECTAS
    SELECT PREGUNTAS_ID_PREGUNTAS AS PREGUNTA, ALTERNATIVAS_ID_ALTERNATIVAS AS ALTERNATIVA_CORRECTA 
    FROM PREGUNTA_ALTERNATIVA
    WHERE VALOR = 1
    ORDER BY PREGUNTAS_ID_PREGUNTAS;
   
    --INCORRECTAS
    SELECT PREGUNTAS_ID_PREGUNTAS AS PREGUNTA, ALTERNATIVAS_ID_ALTERNATIVAS AS ALTERNATIVA_CORRECTA 
    FROM PREGUNTA_ALTERNATIVA
    WHERE VALOR = 0
    ORDER BY PREGUNTAS_ID_PREGUNTAS;
    

--PREGUNTA 4
SELECT CURSO.ID_CURSO AS CURSO, COUNT (ALUMNO.ID_ALUMNO) AS CANTIDAD_ALUMNOS FROM CURSO
INNER JOIN ALUMNO ON ALUMNO.CURSO_ID_CURSO = CURSO.ID_CURSO
WHERE ID_CURSO<3
GROUP BY CURSO.ID_CURSO;


--PREGUNTA 5
SELECT ALUMNO.NOMBRE, COUNT (RESULTADO.PREGUNTAS_ID_PREGUNTAS) AS PREGUNTAS_CORRECTAS FROM RESULTADO
INNER JOIN ALUMNO ON ALUMNO.ID_ALUMNO = RESULTADO.ALUMNO_ID_ALUMNO
WHERE ALTERNATIVAS_ID_ALTERNATIVAS IN (SELECT VALOR FROM PREGUNTA_ALTERNATIVA 
                                     WHERE VALOR =1)
GROUP BY ALUMNO.NOMBRE
ORDER BY ALUMNO.NOMBRE;

--PREGUNTA 6

--PREGUNTA 7
SELECT CURSO.ID_CURSO, ALUMNO.NOMBRE, COUNT (RESULTADO.PREGUNTAS_ID_PREGUNTAS) AS PREGUNTAS_CORRECTAS FROM RESULTADO
INNER JOIN ALUMNO ON ALUMNO.ID_ALUMNO = RESULTADO.ALUMNO_ID_ALUMNO
INNER JOIN CURSO ON CURSO.ID_CURSO = ALUMNO.CURSO_ID_CURSO
WHERE ALTERNATIVAS_ID_ALTERNATIVAS IN (SELECT VALOR FROM PREGUNTA_ALTERNATIVA 
                                     WHERE VALOR =1)
GROUP BY CURSO.ID_CURSO,ALUMNO.NOMBRE
HAVING COUNT (RESULTADO.PREGUNTAS_ID_PREGUNTAS) >=2
ORDER BY ID_CURSO,ALUMNO.NOMBRE;


--PREGUNTA 8


SELECT  CURSO.ID_CURSO AS CURSO, TEST.NOMBRE_TEST AS TEST, SUM(PREGUNTAS.PUNTAJE) as PUNTAJE_TOTAL FROM ALUMNO
INNER JOIN TEST ON TEST.ID_TEST = ALUMNO.TEST_ID_TEST
INNER JOIN CURSO ON CURSO.ID_CURSO = ALUMNO.CURSO_ID_CURSO
INNER JOIN RESULTADO ON RESULTADO.ALUMNO_ID_ALUMNO = ALUMNO.ID_ALUMNO
INNER JOIN PREGUNTAS ON PREGUNTAS.ID_PREGUNTAS = RESULTADO.PREGUNTAS_ID_PREGUNTAS
WHERE ALTERNATIVAS_ID_ALTERNATIVAS IN (SELECT VALOR FROM PREGUNTA_ALTERNATIVA 
                                     WHERE VALOR =1)
GROUP BY CURSO.ID_CURSO, TEST.NOMBRE_TEST, PREGUNTAS.PUNTAJE
ORDER BY CURSO.ID_CURSO, TEST.NOMBRE_TEST;


